% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read.R
\name{read.obs.profiles}
\alias{read.obs.profiles}
\title{Read and Parse Observed Profile Data}
\usage{
read.obs.profiles(
  file,
  obs.sheet = 1,
  reference.sheet = 2,
  molecules = list(),
  id.filter = NA,
  var.pref = c("SD", "SEM", "GSD")
)
}
\arguments{
\item{file}{`character(1)`. Path to the Excel file containing the observed and reference data.}

\item{obs.sheet}{`numeric` or `character`. Sheet name or index in `file` with observed profile data. Default is `1`.}

\item{reference.sheet}{`numeric` or `character`. Sheet name or index in `file` with reference metadata. Default is `2`.}

\item{molecules}{`list`. List of molecule definitions used to match against molecule IDs found in the reference sheet.}

\item{id.filter}{`character` or `NA`. Optional vector of IDs to filter profiles. If specified, only profiles with these IDs are returned.}

\item{var.pref}{`character`. Ordered vector of acceptable variance/error column types to use (e.g., `"SD"`, `"SEM"`, `"GSD"`).
The first available type (non-NA values) per ID in this order will be used.}
}
\value{
A `list` of profiles (each an object of class `"profile"`)
}
\description{
This function reads observed concentrationâ€“time profiles and corresponding reference metadata
from an Excel or CSV file. It matches observed data to reference information and extracts
molecule IDs, doses, routes, groups, and error metrics based on user-specified variance preferences.
}
\details{
The function:
* Validates the file and sheet existence and readability.
* Reads reference sheet as text to avoid type guessing issues.
* Validates presence and uniqueness of required columns (`ID`, `Compound`, `Reference`, `Group`, `Citekey`, `Dose`, `Unit Dose`, `Route`) in the reference sheet.
* Matches molecules from reference sheet against the provided `molecules` list.
* Reads observed data and detects `Time`, `Value`, and error columns.
* Chooses the first available/valid error column per ID according to `var.pref`.
* Computes `Min` and `Max` values using the detected error column.
* Filters IDs if `id.filter` is given.
* Returns profiles with metadata and cleaned data frames.

If duplicate time points are found in the observed data for an ID, duplicates are removed.
}
\note{
This function expects specific column names in the sheets. Optional column `N` (population size) is supported but not mandatory.
}
\examples{
\dontrun{
profiles <- read.obs.profiles(
  file = "data.xlsx",
  molecules = list(mol1, mol2),
  var.pref = c("SD", "SEM", "GSD")
)
}

}
